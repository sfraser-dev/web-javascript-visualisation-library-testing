<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootstrap Pure</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .fleet-table th, .fleet-table td {
            text-align: center;
            vertical-align: middle;
        }
        .fleet-year {
            font-weight: bold;
            background-color: #f8f9fa;
        }
        .progress {
            height: 25px;
        }
    </style>
</head>
<body class="container my-4">

    <h2 class="text-center mb-4">Fleet Transition Budget (2026-2030)</h2>

    <!-- Fleet Transition Table -->
    <div class="table-responsive">
        <table class="table table-bordered fleet-table">
            <thead class="table-dark">
                <tr>
                    <th>Vehicle</th>
                    <th>Transition Year</th>
                    <th>Cost (£)</th>
                </tr>
            </thead>
            <tbody id="fleetTableBody">
                <!-- Dynamic Data Will Be Inserted Here -->
            </tbody>
        </table>
    </div>

    <!-- Cumulative Cost Display -->
    <h3 class="text-center mt-5">Cumulative Cost Over Time</h3>
    <div id="cumulativeCostContainer"></div>

    <script>
        // JSON Data for Fleet Transition (4 Fire Appliances, 7 Response Cars, Intermixed)
        const fleetData = [
            { vehicle: "Fire Appliance #1", year: 2026, cost: 350000, type: "fire" },
            { vehicle: "Response Car #1", year: 2026, cost: 40000, type: "response" },
            { vehicle: "Response Car #2", year: 2027, cost: 40000, type: "response" },
            { vehicle: "Fire Appliance #2", year: 2027, cost: 350000, type: "fire" },
            { vehicle: "Response Car #3", year: 2028, cost: 40000, type: "response" },
            { vehicle: "Fire Appliance #3", year: 2028, cost: 350000, type: "fire" },
            { vehicle: "Response Car #4", year: 2029, cost: 40000, type: "response" },
            { vehicle: "Response Car #5", year: 2029, cost: 40000, type: "response" },
            { vehicle: "Fire Appliance #4", year: 2029, cost: 350000, type: "fire" },
            { vehicle: "Response Car #6", year: 2030, cost: 40000, type: "response" },
            { vehicle: "Response Car #7", year: 2030, cost: 40000, type: "response" }
        ];

        // Color mapping based on vehicle type
        const rowColors = {
            fire: "table-warning",
            response: "table-info",
            other: "table-secondary"
        };

        // Generate Fleet Transition Table
        function generateFleetTable() {
            let tableBody = document.getElementById("fleetTableBody");
            tableBody.innerHTML = "";

            fleetData.forEach(item => {
                let row = `
                    <tr class="${rowColors[item.type] || rowColors.other}">
                        <td>${item.vehicle}</td>
                        <td class="fleet-year">${item.year}</td>
                        <td>£${item.cost.toLocaleString()}</td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Generate Cumulative Cost Progress Bars
        function generateCumulativeCost() {
            let container = document.getElementById("cumulativeCostContainer");
            container.innerHTML = "";

            let cumulativeCost = 0;
            let yearlyCost = {};

            // Calculate cumulative cost per year
            fleetData.forEach(item => {
                if (!yearlyCost[item.year]) {
                    yearlyCost[item.year] = 0;
                }
                yearlyCost[item.year] += item.cost;
            });

            let years = Object.keys(yearlyCost).sort();
            let maxCost = Object.values(yearlyCost).reduce((acc, val) => acc + val, 0);

            years.forEach((year, index) => {
                cumulativeCost += yearlyCost[year];
                let percentage = (cumulativeCost / maxCost) * 100;

                let progressBar = `
                    <div class="progress mt-2">
                        <div class="progress-bar bg-${index % 2 === 0 ? 'danger' : 'warning'}" style="width: ${percentage}%;">
                            ${year} (£${cumulativeCost.toLocaleString()})
                        </div>
                    </div>
                `;
                container.innerHTML += progressBar;
            });
        }

        // Initialize the UI
        generateFleetTable();
        generateCumulativeCost();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
